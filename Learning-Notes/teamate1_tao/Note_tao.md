# 学习记录

经过和老师的多次线上会议以及和几位同学的当面交流，主要的问题在于神经网络加速器的设计。

可用的三种方案已经在之前的文档有所罗列，DIgilent杯拟采用DPU实现，Arm杯使用高级语言综合的方法。

## 报名至4.4

现有的学习资料包括Digilent官方推出的两期培训，主题分别是ZYNQ的PS与PL样例、Arm软核的移植。书籍资料购买了《数字积木》，图书馆借阅了《ZYNQ实战指南》《深入理解神经网络》，Bilibili视频课程”Vitis教程“。

-----

- **C语言高级综合**

主要的代码模块分为两项：用以综合的代码和testbanch代码

所需要综合的代码将分为各个运算模块，而非整个神经网络框架。
即需要单独将卷积层、池化层和全连接层分别综合为IP供以调用。

包含的主要运算为卷积运算和采样运算。

testbanch的编写主要是对mnist训练集的读取以检测每一层的可用性，由于只能读取图片的数据和标签，因此无法对每一层的正确性进行检验
第一层卷积层的图片数据可以直接从mnist集中获取，但是池化层及之后的神经网络层的测试数据怎么产生是个问题，不过只是测试可用性的话也可以直接读取数据集里的图片。

由于是已经训练好的神经网络，卷积核的参数以及其他偏置等参量应当是已经确定了的，然而在编写综合代码时，依然需要这些参量的接口，而用于测试时这些参量应该是已经确定了的，因此需要在testbanch中读取这些参量的数据，这些数据的读写需要另外写。

最近还是很摸鱼，看了看网上各种资料，反手又去看看已经跑成功的C代码，尝试着写了写接口变量什么的，发现想要单独将网络的一层拿出来还是需要搞明白整篇代码的。

最近把这个锅暂时丢给苏同学和许同学了。

-----

- **Viits**

运行环境需要在ubuntu下，软件非常大，于是重新安装了虚拟机，废了九牛二虎之力把软件下载下来并且装好了，软件比较新，教程不多，在各个版本之间的区别也比较大，工程细节上遇到的小Bug解决起来比较麻烦

-----

- **ZYNQ**

参考Digilent官方的培训视频，可以在拿到板子后很快对PS、PS有所熟悉

已知晓移植软核流程，知晓VIVADO上的系统设计流程

-----

- **问题**

无开发板，~~看视频好像是会了但会不会不知道~~，

硬件加速器资料杂且宽泛，很难有明确的着手写的方向，

工具链不熟悉，

- **会议总结**

不出所料，问题一堆，本菜鸡暴风哭泣
C语言综合时不能综合动态内存分配问题
苏同学尝试矩阵卷积运算综合出了千行代码，测试波形看不懂，拟再用最基本的运算进行验证
许同学在用OpenCV写图片的读取，但不清楚FPGA上如何实现，我推荐了HLS视频库工具，
而我想要一块板子动动手。于是任务是熟悉Soc设计过程。

~~上床睡觉！下周再说！~~

-----

## 4.4-4.10

- **企业培训第一弹学习记录**

板卡：zybo-Z7-20
芯片：Xilinx XC7Z020-1CLG400C & Artix-7（ARM Cortex-A9双核 & FPGA）
存储器：1GB DDR3；16MB FLASH；MicroSD卡槽

Vivado建立工程：
Github上clone官方的boards文件放到Vivado目录下，新建工程时直接可以选择对应板卡即可

PL端示例：
添加source文件和约束文件，综合完成之后进行烧录即可

PS端实例：
完成系统设计后生成比特文件打开SDK进行编程

虚拟仪器测试数字信号I/O示例（Pmod）接口：Waveform软件

PS与PL互联：AXI interconnet


- **C语言高级综合**

参照先前对整个神经网络的细化，我参照了github上的项目，将卷积和池化运算单独拿了出来，分别进行了C仿真和综合，综合成功，已经封装为IP加入到FPGA系统中，将进一步在SDK上对这两个模块进行调用测试。

